
![KakaoTalk_20230714_164531507](https://github.com/JSON-loading-and-unloading/Optimizing-Java/assets/106163272/9c7f2f56-e378-4652-a8f2-3c86603e94c0)
(기억장치 계층 구조)<br>
위 계층 구조에서 cpu와 캐시를 보고 이들이 데이터를 주고 받을 때,<br>
찾고 있는 데이터의 메모리 주소는 먼저 캐시 메모리에서 이용된다. 메모리 주소를 이용하여 찾고 있는 데이터가 캐시 블록에 있는지 여부를 식별하는데 사용한다.<br>
Cache Hit(캐시 히트)는 캐시 메모리에 찾는 데이터가 존재하였을 때를 나타내며,<br>
Cache Miss(캐시 미스)는 캐시 메모리에 찾는 데이터가 존재하지 않음을 나타낸다.<br>
Cache Miss가 발생하면, 메모리 저장소로부터 필요한 데이터를 찾아 캐시 메모리에 로드한다
<br>
<br>
L1 캐시 (Level 1 Cache): <br>

L1 캐시는 CPU 코어에 가장 가까운 레벨의 캐시입니다.<br>
명령어 캐시와 데이터 캐시로 나누어질 수 있으며, 각각 L1I (Instruction) 캐시와 L1D (Data) 캐시로 알려져 있습니다.<br>
명령어 캐시는 CPU가 실행할 명령어를 저장하고, 데이터 캐시는 CPU가 처리할 데이터를 저장합니다.<br>
L1 캐시는 매우 작지만 매우 빠르며, 일반적으로 몇 KB에서 몇 MB 사이의 용량을 가집니다.<br><br><br>

L2 캐시 (Level 2 Cache):<br>

L2 캐시는 L1 캐시보다 느리지만 크기는 더 큰 캐시입니다.<br>
여러 개의 CPU 코어가 공유하는 공유 캐시(shared cache)로 사용될 수도 있습니다.<br>
L1 캐시의 데이터를 보조하고, L1 캐시에서 놓친 데이터를 검색하는 역할을 수행합니다.<br>
L2 캐시는 용량이 L1 캐시보다 크며, 몇 십 KB에서 몇 MB 사이의 용량을 가질 수 있습니다.<br><br><br>

L3 캐시 (Level 3 Cache):<br>

L3 캐시는 여러 개의 CPU 코어 또는 프로세서 간에 공유되는 큰 용량의 캐시입니다.<br>
L3 캐시는 L1, L2 캐시보다 더 느리지만 크기는 더 큽니다.<br>
주로 멀티코어 프로세서에서 사용되며, 코어 간 데이터 공유와 캐시 일관성 유지를 지원합니다.<br>
L3 캐시는 몇 MB에서 몇십 MB에 이를 수 있는 용량을 가질 수 있으며, 프로세서에 따라 다를 수 있습니다.<br><br><br>


<h4>캐시 일관성 프로토콜</h4>
ex) 디렉토리 프로토콜, 스누핑 프로토콜

캐시 일관성(영어: Cache Coherence)이란<br>
공유 메모리 시스템에서 각 클라이언트(혹은 프로세서)가 가진 로컬 캐시 간의 일관성을 의미함.<br>

각 클라이언트가 자신 만의 로컬 캐시를 가지고<br>
다른 여러 클라이언트와 메모리를 공유하고 있을 때<br>
캐시의 갱신으로 인한 데이터 불일치 문제가 발생함.<br>
![캡처](https://github.com/JSON-loading-and-unloading/Optimizing-Java/assets/106163272/242ca2d9-622d-46d8-a2f2-5fbf75e86fe5)

예를 들어 변수 X에 대해서 두 클라이언트가 변수 X를 공유하고 있고 그 값이 0이라고 하자.<br>

이때 클라이언트 1(그림의 윗쪽)이 X에 1을 대입하였고<br>
클라이언트 2(그림의 아래쪽)가 변수 X를 읽어들이게 되면<br>
클라이언트 2는 클라이언트 1에 의해 수정된 값인 1을 받아들이는 것이 아니라<br>
현재 자신의 로컬 캐시에 있는 0을 읽어들이게 된다.<br>

따라서 캐시 1, 2는 같은 X라는 변수에 대해 다른 값을 가지게 되므로 데이터 불일치 문제가 발생한다.<br>

따라서 하드웨어 차원에서 항상 최신내용을 읽을 수 있게 캐시 일관성(Cache Coherence)을 지원해야함.<br>

캐시 일관성을 유지한다고 하는 것은<br>
이러한 데이터 불일치 현상을 없애는 것을 의미함.<br>

캐시 일관성을 유지하기 위해서는<br>
다른 프로세서가 갱신한 캐시 값을 곧바로 혹은 지연하여<br>
다른 프로세서에서 사용할 수 있도록 해주어야 함.<br>
https://goodgid.github.io/Cache-Coherence/
(참고 자료)<br>







