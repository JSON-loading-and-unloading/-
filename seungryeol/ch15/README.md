<h1>자바 9와 미래</h1>

<h2>자바 9에서 소소하게 개선된 성능</h2>

<h3>코드 캐시 세그먼트화</h3>

자바9부터 코드 캐시 성능을 개선코자 다음 항목별 영역으로 분리했다.</br>
 - 인터프리터 등의 논메서드 코드
 - 프로파일드 코드
 - 논프로파일드 코드
=> 스위퍼 가동 시간이 짧아지고 풀 최적화 코드에 대한 코드 지역성이 향상</br>

<h3>콤팩트 스트링</h3>
char는 16비트 타입이라서 ASCLL 스트링을 저장하면 실제로 필요한 공간의 2개 정도를 더 차지한다.</br>
자바 9이후 콤팩트스트링덕분에 스트링 단위로 최적화할 수 있다.</br>
char[] => byte[]</br></br>

※콤팩트 스트링 기능은 -XX:-CompactStrings, -XX:+CompactStrings스위치로 각각 끄고 켤 수 있다.</br>

<h3>새로운 스트링 연결</h3>

이전에는 방대한 바이트코드가 있었지만</br>
자바 9부터는 invokedynamic을 활용하여</br>
StringConcatFactory.makeConcatWithConstants()라는 팩토리 메서드로 스트링 연결 레시피를 제공한다.</br></br>

<h3>c2컴파일러 개선</h3>
cpu가 SIMD확장 기능을 응용하며 컴파일러 성능 개선을 기대할 수 있다.</br>
SIMD에 따른 기존 인트린직 개선 및 추가</br>
 - 마스킹된 벡터 포스트루프</br>
 - 슈퍼워드 루프 펼치기 분석</br>
 - 멀티비저닝으로 범위 체크 제거</br>
 - 배정도 제곱근 벡터화 지원</br>
 - 병렬 스트링의 벡터화 개선</br>
 - 슈퍼워드를 개선하여 인텔 AVX CPU상에서 벡터 조건부 이동지원</br></br>


 <h3>G1 새 버전</h3>

 G1은 중단 시간을 쉽게 튜닝하고 더 효과적으로 제어하는 특정을 지닌, 여러 가지 문제를 한꺼번에 해결하고자 설계된 수집기이다.</br>
 (자바9부터는 디폴트 수집기가 되었다.)</br>

 <h2>자바 10과 그 이후 버전</h2>

 <h3>자바 10</h3>
자바 10의 주요 특성</br>
 - 286 : 지역 변수 타입 추론</br>
 - 296 : JDK 포레스트를 단일 리파지터리로 통합</br>
 - 304 : 가비지 수집기 인터페이스</br>
 - 307 : G1에서 풀 병렬 GC 구현</br>
 - 310 : 애플리케이션 클래스 데이터 공유</br>
 - 312 : 스레드 로컬 핸드쉐이크</br>

 283 : </br>
 지역 변수를 선언할 때 반복되는 코드를 줄여 쓸 수 있다.</br>
 ```
  var list = new ArrayList<String>();
  var stream = list.stream();
```
</br>
296 :</br>
완전히 내부적인 문제이다.</br></br>

304 : </br>
 서로 다른 가비지 수집기의 코드를 더 분리해서 동일한 jdk빌드에서 가비지 수집기 인터페이스를 깔끔하게 하자는 아이디어.(성능 무관)</br></br>

307 : </br>
  G1 가비지 수집기의 문제점을 해결</br>
  자바 9 G1에 구현된 풀 GC는 싱글 스레드인 마크-스위프-컴팩트 알고리즘을 사용한다</br>
  => 알고리즘을 병렬화해서 G1에서 풀 GC가 발생할 경우, 같은 개수의 스레드를 그대로 동시 수집에 사용하자는 발상</br></br>

310 :</br>
  자바 5에서 도입된 클래스 데이터 공유 특성을 확장시키는 제안.</br>
  jvm이 일습의 클래스를 기록해서 공유 아카이브 파일 하나로 처리</br>
  => 파일을 메모리에 매핑하면 실행할 때 시작 시간을 아낄 수 있고, 여러 jvm이 공유할 수도 있어 같은 호스트에서 멀티 jvm을 실행하는 환경은 전체 메모리 사용량이 줄어든다.</br>
312 :</br>
  전역 vm 세이프포인트를 수행하지 않고 애플리케이션 스레드에 콜백을 실행할 수 있게 해서 vm 성능을 개선하는 토대를 제공하는 것</br>
  => jvm이 스레드 전체가 아니라, 개별 스레드 단위로 멈출 수 있게 하자는 것</br>
  위 효과로</br>
  - 스택 트레이스 샘플을 획득하는 영향도를 낮출 수 있다.</br>
  - 신호 의존도가 줄어들어 스택 트레이스 샘플링을 더 잘할 수 있다.</br>
  - 바이어스를 취소할 때 개별 스레드만 중단시킬 수 있어서 바이어스 락킹 작업이 향상된다.</br>
  - jvm에서 일부 메모리 배리어를 제거</br></br>
    
 

